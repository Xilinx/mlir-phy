<!-- Autogenerated by mlir-tblgen; don't manually edit -->
# 'layout' Dialect

This dialect defines the placement and routing of the graph defined in the
'spatial' dialect.  In this dialect, Each node or queue vertex can be
assigned a target-dependent slot, e.g., a core in the CPU, a coroutine in
a host, a core or a memory bank in an AIE tile, or a reconfiguration slot
in FPGA.  Each flow edge can be assigned an array of target-dependent
wires, e.g., the switch boxes for a stream to flow through AIE tiles or a
set of anchor registers between FPGA slots.

This dialect is intended to be target-dependent, and forms an unambiguous
description of the physical design when combined with the spatial dialect
and when all operations in the spatial dialect has their wire or slot
specified.  It separates hardware design from logic.

[TOC]

## Operation definition

### `layout.device` (::phy::layout::DeviceOp)

usage of a device


Syntax:

```
operation ::= `layout.device` `<` $device `>` regions attr-dict
```

An operation that uses an abstract physical device for the enclosing region.
The region is used to place and route vertices and edges onto the device.
The slots for placement, and the wires for routing, are dependent on which
device is used.  This operation must be enclosed by a 'layout.platform'
operation.

Example:

```mlir
layout.platform<"versal"> {
  layout.device<"aie"> {
    layout.place<"tile/7.2/core">(%node)
    layout.route<["tile/7.2/memory-access"]>(%flow)
  }
}
```

Traits: HasParent<PlatformOp>, NoRegionArguments, SingleBlockImplicitTerminator<EndOp>

#### Attributes:

| Attribute | MLIR Type | Description |
| :-------: | :-------: | ----------- |
| `device` | ::mlir::StringAttr | string attribute

### `layout.end` (::phy::layout::EndOp)

end of usage of platform or device


Syntax:

```
operation ::= `layout.end` attr-dict
```

'layout.end' is an implied terminator for the 'layout.platform' or
'layout.device' regions.  You do not need to manually write it.

Traits: HasParent<PlatformOp, DeviceOp>, Terminator

### `layout.place` (::phy::layout::PlaceOp)

placement of a vertex


Syntax:

```
operation ::= `layout.place` `<` $slot `>` `(` $vertex `:` type($vertex)  `)` attr-dict
```

An operation that place the 'vertex' to the specific slot of the
enclosing device.  This operation must be enclosed by a 'layout.device'
operation.  The 'slot' argument is target-dependent and is
comma-seperated.  Please check the documentation of the platform and the
device.

Depending on the device, a slot may be time-multiplexed by multiple nodes
or queues.  In this case, the actual supported concurrency may be reduced.
This sharing can be limited or required using `layout.share.*` attributes
on the `spatial` operations.

Example:

```mlir
layout.place<["tile/7.2/core"]>(%node)
layout.place<["tile/7.2/buffer"]>(%queue)
```

Traits: HasParent<DeviceOp>

#### Attributes:

| Attribute | MLIR Type | Description |
| :-------: | :-------: | ----------- |
| `slot` | ::mlir::StringAttr | string attribute

#### Operands:

| Operand | Description |
| :-----: | ----------- |
| `vertex` | a queue or a node

### `layout.platform` (::phy::layout::PlatformOp)

usage of a platform


Syntax:

```
operation ::= `layout.platform` `<` $platform `>` regions attr-dict
```

An operation that uses an abstract physical platform for the enclosing region.
The region is used to place and route vertices and edges onto the platform.
The slots for placement, and the wires for routing, are dependent on which
platform is used.  This operation must be enclosed by a module or another
'layout.platform' operation.

Example:

```mlir
layout.platform<"versal"> {
  layout.device<"pl"> {}
  layout.route<["pl-aie"]>(%flow1)
}
```

Traits: HasParent<mlir::ModuleOp, PlatformOp>, NoRegionArguments, SingleBlockImplicitTerminator<EndOp>

#### Attributes:

| Attribute | MLIR Type | Description |
| :-------: | :-------: | ----------- |
| `platform` | ::mlir::StringAttr | string attribute

### `layout.route` (::phy::layout::RouteOp)

route of a flow connection


Syntax:

```
operation ::= `layout.route` `<` $wires `>` `(` $src `:` type($src) `->` $dest `:` type($dest) `)` attr-dict
```

An operation that route the flow, which connects the 'src' vertex to the
'dest' vertex, to the specific wires of the enclosing device or platform.
The 'wires' argument is a list of slots and is target-dependent.  Please
check the documentation of the platform and the device.

Depending on the device, a wire may be time-multiplexed by multiple flows.
In this case, the actual supported concurrency may be reduced.  This
sharing can be limited or required using layout.share.* attributes on the
spatial operations.

Depending on the device, a wire may contain buffering or caching.  Usage
or rejection of such a wire can be specified using `layout.wire.*`
attributes on this operation.

Example:

```mlir
layout.route<["tile/7.2/dma/mm2s0",
              "tile/7.3/switchbox/7.2-8.3",
              "tile/8.3/dma/s2mm0",
              "tile/8.3/double-buffering",
              "tile/8.3/memory-access"]>(
                %n: !spatial.node
             -> %q: !spatial.queue<memref<8xi32>>)
```

Traits: HasParent<PlatformOp, DeviceOp>

#### Attributes:

| Attribute | MLIR Type | Description |
| :-------: | :-------: | ----------- |
| `wires` | ::mlir::ArrayAttr | string array attribute

#### Operands:

| Operand | Description |
| :-----: | ----------- |
| `src` | a queue or a node
| `dest` | a queue or a node

